{% extends "base.html" %}
{% block content %}
<div class="max-w-3xl mx-auto">
  <div class="bg-white p-10 rounded-[40px] border border-red-100 shadow-xl shadow-red-50">
    <div class="inline-flex p-4 rounded-3xl bg-red-50 mb-4 text-red-500">
      <i data-lucide="shield-alert" class="w-8 h-8"></i>
    </div>
    <h2 class="text-2xl font-extrabold text-slate-900 mb-2">403 Forbidden</h2>
    <p class="text-slate-600 mb-3">Request blocked by WebAppFirewall.</p>
    <p class="text-sm font-semibold text-red-600 mb-6">Detected: {{ attack_type }}</p>
    {% if blocked_payload %}
    <div class="mb-6 rounded-2xl border border-red-100 bg-red-50 p-4">
      <p class="text-xs font-semibold text-red-700 mb-2">Malicious Input Pattern</p>
      <code class="text-xs text-red-800 break-all">{{ blocked_payload[:250] }}</code>
    </div>
    {% endif %}
    <div class="flex gap-3">
      <a href="{{ url_for('simulate') }}" class="px-5 py-3 bg-red-500 text-white rounded-xl text-sm font-bold hover:bg-red-600">Return to Simulator</a>
      <a href="{{ url_for('home') }}" class="px-5 py-3 bg-slate-100 text-slate-700 rounded-xl text-sm font-bold hover:bg-slate-200">Go to Overview</a>
    </div>
  </div>
</div>
{% endblock %}
